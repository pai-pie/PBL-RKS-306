<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Success - GuardianTix</title>
  <style>
    body { font-family: Arial, sans-serif; background: #0f0f1c; color: white; text-align: center; margin: 0; }
    .container { max-width: 500px; margin: 60px auto; background: #1c1c2b; padding: 25px; border-radius: 12px; box-shadow: 0 0 15px #2ecc71; }
    h1 { color: #2ecc71; }
    .details { margin: 20px 0; font-size: 18px; }
    .code { font-size: 22px; font-weight: bold; color: #f1c40f; margin: 20px 0; }
    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
    button { padding: 12px 20px; background: #f1c40f; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; }
    button:hover { opacity: 0.9; }
    .back { background: #3498db; color: white; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ‰ Purchase Successful!</h1>
    <div class="details" id="ticketDetails"></div>
    <div class="code" id="bookingCode"></div>
    
    <div class="buttons">
      <button onclick="downloadTicket()">Download E-Ticket</button>
      <button class="back" onclick="goHome()">Back to Homepage</button>
    </div>
  </div>

  <script>
    // Ambil parameter dari URL
    const urlParams = new URLSearchParams(window.location.search);
    const ticket = urlParams.get("ticket") || "Standard";
    const method = urlParams.get("method") || "Unknown";

    // Generate kode booking unik
    function generateCode() {
      const now = new Date();
      const datePart = now.getFullYear().toString().slice(-2) +
                       (now.getMonth()+1).toString().padStart(2,"0") +
                       now.getDate().toString().padStart(2,"0");
      const randomPart = Math.random().toString(36).substring(2,6).toUpperCase();
      return `GTX-${datePart}-${randomPart}`;
    }

    const bookingCode = generateCode();

    // Tampilkan detail
    document.getElementById("ticketDetails").innerHTML = 
      `Ticket Type: <b>${ticket}</b><br>Payment Method: <b>${method}</b>`;

    document.getElementById("bookingCode").innerText = 
      `Booking Code: ${bookingCode}`;

    // Download e-ticket (simulasi .txt file)
    function downloadTicket() {
      const content = 
`ðŸŽ« GuardianTix E-Ticket
------------------------
Booking Code: ${bookingCode}
Ticket Type : ${ticket}
Payment     : ${method}

Show this e-ticket at the venue.
Enjoy the concert! ðŸŽ¶`;

      const blob = new Blob([content], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `E-Ticket-${bookingCode}.txt`;
      a.click();
      URL.revokeObjectURL(url);
    }

    // Kembali ke homepage
    function goHome() {
      window.location.href = "homepage.html";
    }
  </script>
</body>
</html>
