<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Success - GuardianTix</title>
  <style>
    body { font-family: Arial, sans-serif; background: #0f0f1c; color: white; text-align: center; margin: 0; }
    .container { max-width: 500px; margin: 60px auto; background: #1c1c2b; padding: 25px; border-radius: 12px; box-shadow: 0 0 15px #2ecc71; }
    h1 { color: #2ecc71; }
    .details { margin: 20px 0; font-size: 18px; }
    .code { font-size: 22px; font-weight: bold; color: #f1c40f; margin: 20px 0; }
    .buttons { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }
    button { padding: 12px 20px; background: #f1c40f; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; }
    button:hover { opacity: 0.9; }
    .back { background: #3498db; color: white; }
  </style>
</head>
<body>

  <div class="container">
    <h1>ðŸŽ‰ Purchase Successful!</h1>
    <div class="details" id="ticketDetails"></div>
    <div class="code" id="bookingCode"></div>
    
    <div class="buttons">
      <button onclick="ticket.download()">Download E-Ticket</button>
      <button class="back" onclick="ticket.goHome()">Back to Homepage</button>
    </div>
  </div>

  <script>
    class Ticket {
      constructor(ticketType, method){
        this.ticketType = ticketType;
        this.method = method;
        this.bookingCode = this.generateCode();
        this.showDetails();
      }

      generateCode(){
        const now = new Date();
        const datePart = now.getFullYear().toString().slice(-2)+
                         (now.getMonth()+1).toString().padStart(2,"0")+
                         now.getDate().toString().padStart(2,"0");
        const randomPart = Math.random().toString(36).substring(2,6).toUpperCase();
        return `GTX-${datePart}-${randomPart}`;
      }

      showDetails(){
        document.getElementById("ticketDetails").innerHTML = 
          `Ticket Type: <b>${this.ticketType}</b><br>Payment Method: <b>${this.method}</b>`;
        document.getElementById("bookingCode").innerText = `Booking Code: ${this.bookingCode}`;
      }

      download(){
        const content = `ðŸŽ« GuardianTix E-Ticket
------------------------
Booking Code: ${this.bookingCode}
Ticket Type : ${this.ticketType}
Payment     : ${this.method}

Show this e-ticket at the venue.
Enjoy the concert! ðŸŽ¶`;
        const blob = new Blob([content],{type:"text/plain"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url; a.download = `E-Ticket-${this.bookingCode}.txt`; a.click();
        URL.revokeObjectURL(url);
      }

      goHome(){ window.location.href = "homepage.html"; }
    }

    const urlParams = new URLSearchParams(window.location.search);
    const ticketType = urlParams.get("ticket") || "Standard";
    const method = urlParams.get("method") || "Unknown";
    const ticket = new Ticket(ticketType, method);
  </script>

</body>
</html>
